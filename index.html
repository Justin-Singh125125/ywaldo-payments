<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://js.braintreegateway.com/web/dropin/1.23.0/js/dropin.js"></script>
</head>
<style></style>

<body>
  <div id="root">
    <div id="dropin-container"></div>
    <button id="submit-button">Request payment method</button>

    <button id="test-button" onclick="test();">Done</button>
  </div>
  <!-- <script type="text/javascript" src="main.bundle.js"></script> -->

  <script>
    var button = document.querySelector("#submit-button");

    braintree.dropin.create(
      {
        authorization: "sandbox_fwrwczp4_c67sf9xqwmk5xxhs",
        selector: "#dropin-container",
      },
      function (err, instance) {
        button.addEventListener("click", function () {
          instance.requestPaymentMethod(async function (err, payload) {
            // Submit payload.nonce to your server
            const nonce = payload.nonce;
            if (nonce) {
              const url = "https://ywaldo.azurewebsites.net/initialPayment?code=0YSzFrNGyPr49nMG49s6poqGR25HNFmNVaBowlRKUSp0ZftItnaiww==%27"
              const response = await fetch(url, {
                method: 'POST',
                mode: 'cors',
                cache: 'no-cache',
                headers: {
                  'Content-Type': 'application/json',
                  'Cookie': 'ARRAffinity=b5c00dccdec3665a65f7f0a8f6742909bc8c035379ae6cc0f65a59753d7196f4',
                  'Access-Control-Allow-Origin': '*'
                },
                body: JSON.stringify(nonce)
              });
              const data = response.json();
              console.log(data);
            }
          });
        });
      }
    );

    function test() {
      console.log("test");
      history.pushState(
        null,
        null,
        "https://justin-singh125125.github.io/ywaldo-payments/thankyou.html/?token=asdjcvkjencnc"
      );
    }
  </script>
</body>

</html>